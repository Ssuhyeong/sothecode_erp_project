{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport { useEffect } from 'react';\nimport { useNavigate } from \"react-router-dom\";\nconst client = axios.create({\n  baseURL: 'http://localhost:3001',\n  timeout: 1000\n}); // 200 : 성공, 201 : 토큰 재발행, 400 : 인증 X(여러가지 이유),\n\nclient.interceptors.request.use(function (config) {\n  const Authorization = localStorage.getItem('Authorization');\n\n  if (!user) {\n    config.headers[\"Authorization\"] = null;\n    return config;\n  }\n\n  const {\n    accessToken,\n    refreshToken\n  } = JSON.parse(user);\n  config.headers[\"Authorization\"] = `Bearer ${Authorization}`;\n  config.headers[\"refreshToken\"] = refreshToken;\n  return config;\n}); // 응답\n\nconst Interceptor = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const navigate = useNavigate();\n  useEffect(() => {\n    // Authorization 헤더가 비어있다면 갱신 안해도되는 거임\n    client.interceptors.response.use(function (response) {\n      axios.defaults.headers.common['Authorization'] = response.headers.authorization;\n      return response;\n    }, function (error) {\n      // 백엔드에서 jwt(검증+갱신) 후 토큰 만료(액세스+리프레쉬)\n      if (error.response && error.response.status === 400) navigate(\"/login\", {\n        replace: true\n      });\n      return Promise.reject(error);\n    });\n  }, []);\n  return children;\n};\n\n_s(Interceptor, \"0pNeyzXk/ByIxyERsdaIrG6js9s=\", false, function () {\n  return [useNavigate];\n});\n\n_c = Interceptor;\nexport default client;\nexport { Interceptor };\n\nvar _c;\n\n$RefreshReg$(_c, \"Interceptor\");","map":{"version":3,"names":["axios","useEffect","useNavigate","client","create","baseURL","timeout","interceptors","request","use","config","Authorization","localStorage","getItem","user","headers","accessToken","refreshToken","JSON","parse","Interceptor","children","navigate","response","defaults","common","authorization","error","status","replace","Promise","reject"],"sources":["/home/song/serp_front/src/utils/axios.js"],"sourcesContent":["import axios from 'axios';\nimport { useEffect } from 'react';\nimport { useNavigate } from \"react-router-dom\";\n\nconst client = axios.create(\n  {\n    baseURL : 'http://localhost:3001',\n    timeout: 1000,\n  }\n);\n// 200 : 성공, 201 : 토큰 재발행, 400 : 인증 X(여러가지 이유),\nclient.interceptors.request.use(\n  function (config) {\n    const Authorization = localStorage.getItem('Authorization');\n    if (!user) {\n      config.headers[\"Authorization\"] = null;\n      return config\n    }\n    const { accessToken, refreshToken } = JSON.parse(user)\n    config.headers[\"Authorization\"] = `Bearer ${Authorization}`;\n    config.headers[\"refreshToken\"] = refreshToken;\n    return config\n  }\n)\n\n// 응답\nconst Interceptor = ({children}) => {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    // Authorization 헤더가 비어있다면 갱신 안해도되는 거임\n    client.interceptors.response.use(\n      function (response) {\n        \n           axios.defaults.headers.common['Authorization'] = response.headers.authorization;\n        return response\n      },\n      function (error) {\n        // 백엔드에서 jwt(검증+갱신) 후 토큰 만료(액세스+리프레쉬)\n        if (error.response && error.response.status === 400) \n            navigate(\"/login\", { replace: true })\n        \n        return Promise.reject(error) \n      }\n    )\n  }, [])\n  return children;\n}\n\n\nexport default client;\nexport {Interceptor};"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,SAASC,WAAT,QAA4B,kBAA5B;AAEA,MAAMC,MAAM,GAAGH,KAAK,CAACI,MAAN,CACb;EACEC,OAAO,EAAG,uBADZ;EAEEC,OAAO,EAAE;AAFX,CADa,CAAf,C,CAMA;;AACAH,MAAM,CAACI,YAAP,CAAoBC,OAApB,CAA4BC,GAA5B,CACE,UAAUC,MAAV,EAAkB;EAChB,MAAMC,aAAa,GAAGC,YAAY,CAACC,OAAb,CAAqB,eAArB,CAAtB;;EACA,IAAI,CAACC,IAAL,EAAW;IACTJ,MAAM,CAACK,OAAP,CAAe,eAAf,IAAkC,IAAlC;IACA,OAAOL,MAAP;EACD;;EACD,MAAM;IAAEM,WAAF;IAAeC;EAAf,IAAgCC,IAAI,CAACC,KAAL,CAAWL,IAAX,CAAtC;EACAJ,MAAM,CAACK,OAAP,CAAe,eAAf,IAAmC,UAASJ,aAAc,EAA1D;EACAD,MAAM,CAACK,OAAP,CAAe,cAAf,IAAiCE,YAAjC;EACA,OAAOP,MAAP;AACD,CAXH,E,CAcA;;AACA,MAAMU,WAAW,GAAG,QAAgB;EAAA;;EAAA,IAAf;IAACC;EAAD,CAAe;EAClC,MAAMC,QAAQ,GAAGpB,WAAW,EAA5B;EAEAD,SAAS,CAAC,MAAM;IACd;IACAE,MAAM,CAACI,YAAP,CAAoBgB,QAApB,CAA6Bd,GAA7B,CACE,UAAUc,QAAV,EAAoB;MAEfvB,KAAK,CAACwB,QAAN,CAAeT,OAAf,CAAuBU,MAAvB,CAA8B,eAA9B,IAAiDF,QAAQ,CAACR,OAAT,CAAiBW,aAAlE;MACH,OAAOH,QAAP;IACD,CALH,EAME,UAAUI,KAAV,EAAiB;MACf;MACA,IAAIA,KAAK,CAACJ,QAAN,IAAkBI,KAAK,CAACJ,QAAN,CAAeK,MAAf,KAA0B,GAAhD,EACIN,QAAQ,CAAC,QAAD,EAAW;QAAEO,OAAO,EAAE;MAAX,CAAX,CAAR;MAEJ,OAAOC,OAAO,CAACC,MAAR,CAAeJ,KAAf,CAAP;IACD,CAZH;EAcD,CAhBQ,EAgBN,EAhBM,CAAT;EAiBA,OAAON,QAAP;AACD,CArBD;;GAAMD,W;UACalB,W;;;KADbkB,W;AAwBN,eAAejB,MAAf;AACA,SAAQiB,WAAR"},"metadata":{},"sourceType":"module"}